# 标注一致性评估方案 (IAA Evaluation Plan)

> Version: 1.0 | 适用于 Taxonomy v2.0

---

## 1. 目标

在生产标注启动前，验证标注指南的可操作性和标注者之间的一致性。
目标指标：所有类别 Cohen's Kappa (κ) > 0.7。

---

## 2. 评估设计

### 2.1 样本选择

| 参数 | 值 | 说明 |
|------|------|------|
| 总样本数 | 50 条 | 涵盖所有 Difficulty 级别和 Intent 类型 |
| 来源 | 真实用户查询 + 合成查询 | 50/50 比例 |
| 难度分布 | beginner: 10, intermediate: 15, advanced: 15, expert: 10 | 接近预期生产分布 |
| Intent 分布 | learn: 10, build: 15, debug: 10, review: 8, decide: 7 | 接近预期生产分布 |

**样本选择标准**:
- 覆盖所有 9 个 Domain 大类中至少 5 个
- 覆盖至少 8 种 Language
- 包含至少 5 条"边界案例"（标注指南中列出的争议场景）
- 排除过于简单（一眼明确）或过于模糊（无法合理标注）的样本

### 2.2 标注者

| 参数 | 值 |
|------|------|
| 标注者人数 | 3 人 |
| 资质要求 | 3+ 年编程经验，熟悉至少 3 种编程语言 |
| 培训 | 阅读标注指南 + 10 条练习标注 + 讨论校准 |
| 独立性 | 独立标注，不允许讨论 |

### 2.3 校准阶段 (Pre-IAA)

在正式 IAA 测试前，进行一轮校准：

1. 全部标注者对 10 条练习样本独立标注
2. 组织讨论会，逐条对比差异
3. 根据讨论结果更新标注指南（补充边界案例裁决）
4. 练习样本不计入正式 IAA 统计

---

## 3. 度量方法

### 3.1 按类别的度量方式

| 类别 | 选择方式 | 度量 | 计算方法 |
|------|---------|------|---------|
| Language | multi-select | Fleiss' κ (per tag) | 对每个 tag 计算标注者是否选中的 κ，取平均 |
| Domain | multi-select | Fleiss' κ (per tag) | 同上 |
| Concept | multi-select | Fleiss' κ (per tag) | 同上 |
| Task | multi-select | Fleiss' κ (per tag) | 同上 |
| Constraint | multi-select | Fleiss' κ (per tag) | 同上 |
| Agentic | multi-select | Fleiss' κ (per tag) | 同上 |
| Context | single-select | Fleiss' κ | 直接在分类标签上计算 |
| Difficulty | single-select | Fleiss' κ | 直接在分类标签上计算 |
| Intent | single-select | Fleiss' κ | 直接在分类标签上计算 |

### 3.2 合格标准

| 级别 | κ 值 | 含义 | 行动 |
|------|------|------|------|
| 优秀 | κ ≥ 0.8 | 几乎完全一致 | 无需调整 |
| 合格 | 0.7 ≤ κ < 0.8 | 实质性一致 | 可投入生产，持续监控 |
| 待改进 | 0.6 ≤ κ < 0.7 | 中等一致 | 需更新标注指南，补充培训后重测 |
| 不合格 | κ < 0.6 | 一致性不足 | 需重新设计该类别定义或合并/拆分标签 |

### 3.3 额外分析

- **混淆矩阵**: 对 single-select 类别（Context, Difficulty, Intent）生成标注者间混淆矩阵，识别最易混淆的标签对
- **按 Difficulty 分层**: 分别计算 beginner/intermediate/advanced/expert 样本的 κ，检查是否某个难度级别一致性特别低
- **争议样本收集**: 标注结果不一致的样本自动收集，作为标注指南更新的输入

---

## 4. 执行时间线

| 阶段 | 时间 | 产出 |
|------|------|------|
| 准备 | 2 天 | 50 条样本选定，标注工具就绪 |
| 培训 | 1 天 | 标注者阅读指南 + 10 条练习 |
| 校准讨论 | 0.5 天 | 练习标注差异讨论，指南更新 |
| 正式标注 | 3 天 | 3 名标注者独立完成 50 条标注 |
| 统计分析 | 1 天 | 计算 κ，生成报告 |
| 迭代 | 2 天 | 针对 κ < 0.7 的类别更新指南并重测 |
| **总计** | **~10 天** | IAA 报告 + 更新后的标注指南 |

---

## 5. 迭代策略

如果某个类别 κ < 0.7:

1. **分析争议样本**: 找出哪些标签/场景导致分歧
2. **更新标注指南**: 补充边界案例裁决规则
3. **重测**: 用新的 20 条样本（含争议场景）重新测试
4. **如仍不合格**: 考虑合并易混淆标签或简化该类别
